#cambio quien posteo a factor
base$Who.said.posted.it. <- as.factor(base$Who.said.posted.it.)
#cambio lenguaje a factor
base$Language.of.your.fact.check <- as.factor(base$Language.of.your.fact.check)
#cambio rating factor
base$Final.rating <- as.factor(base$Final.rating)
#cambio categoría a factor
base$Category <- as.factor(base$Category)
#importo base de paises para extraer continente
paises <- read.csv("https://pkgstore.datahub.io/JohnSnowLabs/country-and-continent-codes-list/country-and-continent-codes-list-csv_csv/data/b7876b7f496677669644f3d1069d3121/country-and-continent-codes-list-csv_csv.csv", sep = "," )
paises$nombre_corto <- stringr::str_split_fixed(paises$Country_Name,",",2)[,1]
paises <- paises[,c("Continent_Name", "nombre_corto")]
#corrijo algunos paises en el df de paises
paises$nombre_corto[paises$nombre_corto == "United Kingdom of Great Britain & Northern Ireland"] <- "United Kingdom"
paises$nombre_corto[paises$nombre_corto == "United States of America"] <- "United States"
paises[nrow(paises)+1, ] = c("Europe", "North Macedonia")
paises$nombre_corto[paises$nombre_corto == "Cote d'Ivoire"] <- "Ivory Coast"
paises$nombre_corto[paises$nombre_corto == "Russian Federation"] <- "Russia"
paises$nombre_corto[paises$nombre_corto == "Syrian Arab Republic"] <- "Syria"
paises$nombre_corto[paises$nombre_corto == "Slovakia (Slovak Republic)"] <- "Slovakia"
paises$nombre_corto[paises$nombre_corto == "Libyan Arab Jamahiriya"] <- "Libya"
paises$nombre_corto[paises$nombre_corto == "Kyrgyz Republic"] <- "Kyrgyzstan"
paises$nombre_corto[paises$nombre_corto == "Timor-Leste"] <- "Timor"
paises[nrow(paises)+1, ] <- c("Asia", "South Korea")
paises[nrow(paises)+1, ] <- c("Asia", "North Korea")
paises[nrow(paises)+1, ] <- c("Europe", "Kosovo")
#corrijo paises mal escritos en la base
base$Country.1[base$Country.1 == "UK"] <- "United Kingdom"
base$Country.1[base$Country.1 == "India "] <- "India"
base$Country.1[base$Country.1 == "DR Congo"] <- "Congo"
levels(base$Country.2) <- as.factor(c(levels(base$Country.2), "Congo"))
base$Country.2[base$Country.2 == "DR Congo"] <- "Congo"
base$Country.2[base$Country.2 == "USA"] <- "United States"
base$Country.2[base$Country.2 == "Spain "] <- "Spain"
base$Country.2[base$Country.2 == "Serbia "] <- "Serbia"
base$Country.2[base$Country.2 == "Croatia "] <- "Croatia"
base$Country.2[base$Country.2 == "Northern Ireland"] <- "United Kingdom"
levels(base$Country.2) <- as.factor(c(levels(base$Country.2), "Papua New Guinea"))
base$Country.2[base$Country.2 == "Papua-New-Guinea"] <- "Papua New Guinea"
levels(base$Country.3) <- as.factor(c(levels(base$Country.3), "Congo"))
base$Country.3[base$Country.3 == "DR Congo"] <- "Congo"
base$Country.3[base$Country.3 == "Serbia"] <- "Serbia"
levels(base$Country.4) <- as.factor(c(levels(base$Country.4), "Congo"))
base$Country.4[base$Country.4 == "DR Congo"] <- "Congo"
#creo cuatro variables continente, 1 por pais
base <- dplyr::left_join(base, paises, by=c("Country.1" = "nombre_corto"), keep= FALSE, suffix=c("1","2"))
base <- dplyr::left_join(base, paises, by=c("Country.2" = "nombre_corto"), keep= FALSE, suffix=c("1","2"))
base <- dplyr::left_join(base, paises, by=c("Country.3" = "nombre_corto"), keep= FALSE, suffix=c("3","4"))
base <- dplyr::left_join(base, paises, by=c("Country.4" = "nombre_corto"), keep= FALSE, suffix=c("3","4"))
#reviso cuales quedaron sin dato
View(base[is.na(base$Continent_Name2) & (base$Country.2 != ""),])
#View(base[is.na(base$Continent_Name2) & (base$Country.2 != ""),])
#arreglo los paises/areas sin continente
#campo country.1
base$Continent_Name1[base$Country.1 == "Middle East"] <- "Asia"
base$Continent_Name1[base$Country.1 == "Asia"] <- "Asia"
base$Continent_Name1[base$Country.1 == "Africa"] <- "Africa"
base$Continent_Name1[base$Country.1 == "North Africa"] <- "Africa"
base$Continent_Name1[base$Country.1 == "West Africa"] <- "Africa"
base$Continent_Name1[base$Country.1 == "Southern Africa"] <- "Africa"
base$Continent_Name1[base$Country.1 == "East Africa"] <- "Africa"
base$Continent_Name1[base$Country.1 == "Europe"] <- "Europe"
base$Continent_Name1[base$Country.1 == "South America"] <- "South America"
base$Continent_Name1[base$Country.1 == "North America"] <- "North America"
#campo country.2
base$Continent_Name2[base$Country.2 == "Middle East"] <- "Asia"
base$Continent_Name2[base$Country.2 == "Asia"] <- "Asia"
base$Continent_Name2[base$Country.2 == "Africa"] <- "Africa"
base$Continent_Name2[base$Country.2 == "North Africa"] <- "Africa"
base$Continent_Name2[base$Country.2 == "West Africa"] <- "Africa"
base$Continent_Name2[base$Country.2 == "Southern Africa"] <- "Africa"
base$Continent_Name2[base$Country.2 == "East Africa"] <- "Africa"
base$Continent_Name2[base$Country.2 == "Europe"] <- "Europe"
base$Continent_Name2[base$Country.2 == "South America"] <- "South America"
base$Continent_Name2[base$Country.2 == "North America"] <- "North America"
#campo country.3
base$Continent_Name3[base$Country.3 == "Venezuela"] <- "Venezuela"
base$Continent_Name3[base$Country.3 == "Middle East"] <- "Asia"
base$Continent_Name3[base$Country.3 == "Asia"] <- "Asia"
base$Continent_Name3[base$Country.3 == "Africa"] <- "Africa"
base$Continent_Name3[base$Country.3 == "North Africa"] <- "Africa"
base$Continent_Name3[base$Country.3 == "West Africa"] <- "Africa"
base$Continent_Name3[base$Country.3 == "Southern Africa"] <- "Africa"
base$Continent_Name3[base$Country.3 == "East Africa"] <- "Africa"
base$Continent_Name3[base$Country.3 == "Europe"] <- "Europe"
base$Continent_Name3[base$Country.3 == "South America"] <- "South America"
base$Continent_Name3[base$Country.3 == "North America"] <- "North America"
#campo country.4
base$Continent_Name4[base$Country.4 == "Central America"] <- "Central America"
table(base$Continent_Name1)
table(base$Continent_Name2)
table(base$Continent_Name3)
table(base$Continent_Name4)
base <- read.csv("Base de datos.csv", sep= ",")
#cambio el formato de fecha de texto a date
base$When.did.you.see.the.claim. <- as.Date(base$When.did.you.see.the.claim., format="%m/%d/%Y")
#cambio formato de pais a factor
base$Country.1 <- as.factor(base$Country.1)
base$Country.2 <- as.factor(base$Country.2)
base$Country.3 <- as.factor(base$Country.3)
base$Country.4 <- as.factor(base$Country.4)
#cambio organizacion a factor
base$Organization <- as.factor(base$Organization)
#cambio quien posteo a factor
base$Who.said.posted.it. <- as.factor(base$Who.said.posted.it.)
#cambio lenguaje a factor
base$Language.of.your.fact.check <- as.factor(base$Language.of.your.fact.check)
#cambio rating factor
base$Final.rating <- as.factor(base$Final.rating)
#cambio categoría a factor
base$Category <- as.factor(base$Category)
#importo base de paises para extraer continente
paises <- read.csv("https://pkgstore.datahub.io/JohnSnowLabs/country-and-continent-codes-list/country-and-continent-codes-list-csv_csv/data/b7876b7f496677669644f3d1069d3121/country-and-continent-codes-list-csv_csv.csv", sep = "," )
paises$nombre_corto <- stringr::str_split_fixed(paises$Country_Name,",",2)[,1]
paises <- paises[,c("Continent_Name", "nombre_corto")]
#corrijo algunos paises en el df de paises
paises$nombre_corto[paises$nombre_corto == "United Kingdom of Great Britain & Northern Ireland"] <- "United Kingdom"
paises$nombre_corto[paises$nombre_corto == "United States of America"] <- "United States"
paises[nrow(paises)+1, ] = c("Europe", "North Macedonia")
paises$nombre_corto[paises$nombre_corto == "Cote d'Ivoire"] <- "Ivory Coast"
paises$nombre_corto[paises$nombre_corto == "Russian Federation"] <- "Russia"
paises$nombre_corto[paises$nombre_corto == "Syrian Arab Republic"] <- "Syria"
paises$nombre_corto[paises$nombre_corto == "Slovakia (Slovak Republic)"] <- "Slovakia"
paises$nombre_corto[paises$nombre_corto == "Libyan Arab Jamahiriya"] <- "Libya"
paises$nombre_corto[paises$nombre_corto == "Kyrgyz Republic"] <- "Kyrgyzstan"
paises$nombre_corto[paises$nombre_corto == "Timor-Leste"] <- "Timor"
paises[nrow(paises)+1, ] <- c("Asia", "South Korea")
paises[nrow(paises)+1, ] <- c("Asia", "North Korea")
paises[nrow(paises)+1, ] <- c("Europe", "Kosovo")
#corrijo paises mal escritos en la base
base$Country.1[base$Country.1 == "UK"] <- "United Kingdom"
base$Country.1[base$Country.1 == "India "] <- "India"
base$Country.1[base$Country.1 == "DR Congo"] <- "Congo"
levels(base$Country.2) <- as.factor(c(levels(base$Country.2), "Congo"))
base$Country.2[base$Country.2 == "DR Congo"] <- "Congo"
base$Country.2[base$Country.2 == "USA"] <- "United States"
base$Country.2[base$Country.2 == "Spain "] <- "Spain"
base$Country.2[base$Country.2 == "Serbia "] <- "Serbia"
base$Country.2[base$Country.2 == "Croatia "] <- "Croatia"
base$Country.2[base$Country.2 == "Northern Ireland"] <- "United Kingdom"
levels(base$Country.2) <- as.factor(c(levels(base$Country.2), "Papua New Guinea"))
base$Country.2[base$Country.2 == "Papua-New-Guinea"] <- "Papua New Guinea"
levels(base$Country.3) <- as.factor(c(levels(base$Country.3), "Congo"))
base$Country.3[base$Country.3 == "DR Congo"] <- "Congo"
base$Country.3[base$Country.3 == "Serbia "] <- "Serbia"
base$Country.3[base$Country.3 == "Venezuela "] <- "Venezuela"
levels(base$Country.4) <- as.factor(c(levels(base$Country.4), "Congo"))
base$Country.4[base$Country.4 == "DR Congo"] <- "Congo"
#creo cuatro variables continente, 1 por pais
base <- dplyr::left_join(base, paises, by=c("Country.1" = "nombre_corto"), keep= FALSE, suffix=c("1","2"))
base <- dplyr::left_join(base, paises, by=c("Country.2" = "nombre_corto"), keep= FALSE, suffix=c("1","2"))
base <- dplyr::left_join(base, paises, by=c("Country.3" = "nombre_corto"), keep= FALSE, suffix=c("3","4"))
base <- dplyr::left_join(base, paises, by=c("Country.4" = "nombre_corto"), keep= FALSE, suffix=c("3","4"))
#reviso cuales quedaron sin dato
#View(base[is.na(base$Continent_Name2) & (base$Country.2 != ""),])
#View(base[is.na(base$Continent_Name2) & (base$Country.2 != ""),])
#arreglo los paises/areas sin continente
#campo country.1
base$Continent_Name1[base$Country.1 == "Middle East"] <- "Asia"
base$Continent_Name1[base$Country.1 == "Asia"] <- "Asia"
base$Continent_Name1[base$Country.1 == "Africa"] <- "Africa"
base$Continent_Name1[base$Country.1 == "North Africa"] <- "Africa"
base$Continent_Name1[base$Country.1 == "West Africa"] <- "Africa"
base$Continent_Name1[base$Country.1 == "Southern Africa"] <- "Africa"
base$Continent_Name1[base$Country.1 == "East Africa"] <- "Africa"
base$Continent_Name1[base$Country.1 == "Europe"] <- "Europe"
base$Continent_Name1[base$Country.1 == "South America"] <- "South America"
base$Continent_Name1[base$Country.1 == "North America"] <- "North America"
#campo country.2
base$Continent_Name2[base$Country.2 == "Middle East"] <- "Asia"
base$Continent_Name2[base$Country.2 == "Asia"] <- "Asia"
base$Continent_Name2[base$Country.2 == "Africa"] <- "Africa"
base$Continent_Name2[base$Country.2 == "North Africa"] <- "Africa"
base$Continent_Name2[base$Country.2 == "West Africa"] <- "Africa"
base$Continent_Name2[base$Country.2 == "Southern Africa"] <- "Africa"
base$Continent_Name2[base$Country.2 == "East Africa"] <- "Africa"
base$Continent_Name2[base$Country.2 == "Europe"] <- "Europe"
base$Continent_Name2[base$Country.2 == "South America"] <- "South America"
base$Continent_Name2[base$Country.2 == "North America"] <- "North America"
#campo country.3
base$Continent_Name3[base$Country.3 == "Middle East"] <- "Asia"
base$Continent_Name3[base$Country.3 == "Asia"] <- "Asia"
base$Continent_Name3[base$Country.3 == "Africa"] <- "Africa"
base$Continent_Name3[base$Country.3 == "North Africa"] <- "Africa"
base$Continent_Name3[base$Country.3 == "West Africa"] <- "Africa"
base$Continent_Name3[base$Country.3 == "Southern Africa"] <- "Africa"
base$Continent_Name3[base$Country.3 == "East Africa"] <- "Africa"
base$Continent_Name3[base$Country.3 == "Europe"] <- "Europe"
base$Continent_Name3[base$Country.3 == "South America"] <- "South America"
base$Continent_Name3[base$Country.3 == "North America"] <- "North America"
#campo country.4
base$Continent_Name4[base$Country.4 == "Central America"] <- "North America"
table(base$Continent_Name1)
table(base$Continent_Name2)
table(base$Continent_Name3)
table(base$Continent_Name4)
table(base$Continent_Name4)[2]
table(base$Continent_Name4)[[2]]
sum(table(base$Continent_Name4))
sum(table(base$Continent_Name4))+sum(table(base$Continent_Name3))+sum(table(base$Continent_Name2))+sum(table(base$Continent_Name1))
sum(total_x_cont$Freq)
total_x_cont <- rbind(as.data.frame(table(base$Continent_Name1)), as.data.frame(table(base$Continent_Name2)))
total_x_cont <- aggregate(total_x_cont$Freq, by=list(Var1 = total_x_cont$Var1), FUN=sum)
sum(total_x_cont$Freq)
total_x_cont <- rbind(as.data.frame(table(base$Continent_Name1)), as.data.frame(table(base$Continent_Name2)), as.data.frame(table(base$Continent_Name3)), as.data.frame(table(base$Continent_Name4)))
sum(total_x_cont$Freq)
sum(table(base$Country.1))+sum(table(base$Country.2))+sum(table(base$Country.3))+sum(table(base$Country.4))
total_x_pais <- rbind(as.data.frame(table(base$Country.1)), as.data.frame(table(base$Country.2)),as.data.frame(table(base$Country.3)),as.data.frame(table(base$Country.4)))
sum(total_x_pais$Freq)
table(total_x_pais)
table(total_x_pais$Freq)
table(total_x_pais$Var1)
View(base[base$Country.1 == "" || base$Country.2 == "" || base$Country.3 == "" || base$Country.4 == "",])
base[base==""]<-NA
base[base==""]<-NA
#leo la base de datos
base <- read.csv("Base de datos.csv", sep= ",")
#hay valores en blanco en lugar de NA. Arreglo eso
base[base==""]<-NA
nulos <- as.data.frame(apply(is.na(base),2,sum))
View(base[base$Country.1 == "" || base$Country.2 == "" || base$Country.3 == "" || base$Country.4 == "",])
#corrección del tipo de datos
#cambio el formato de fecha de texto a date
base$When.did.you.see.the.claim. <- as.Date(base$When.did.you.see.the.claim., format="%m/%d/%Y")
#cambio formato de pais a factor
base$Country.1 <- as.factor(base$Country.1)
base$Country.2 <- as.factor(base$Country.2)
base$Country.3 <- as.factor(base$Country.3)
base$Country.4 <- as.factor(base$Country.4)
#cambio organizacion a factor
base$Organization <- as.factor(base$Organization)
#cambio quien posteo a factor
base$Who.said.posted.it. <- as.factor(base$Who.said.posted.it.)
#cambio lenguaje a factor
base$Language.of.your.fact.check <- as.factor(base$Language.of.your.fact.check)
#cambio rating factor
base$Final.rating <- as.factor(base$Final.rating)
#cambio categoría a factor
base$Category <- as.factor(base$Category)
#importo base de paises para extraer continente
paises <- read.csv("https://pkgstore.datahub.io/JohnSnowLabs/country-and-continent-codes-list/country-and-continent-codes-list-csv_csv/data/b7876b7f496677669644f3d1069d3121/country-and-continent-codes-list-csv_csv.csv", sep = "," )
paises$nombre_corto <- stringr::str_split_fixed(paises$Country_Name,",",2)[,1]
paises <- paises[,c("Continent_Name", "nombre_corto")]
#corrijo algunos paises en el df de paises
paises$nombre_corto[paises$nombre_corto == "United Kingdom of Great Britain & Northern Ireland"] <- "United Kingdom"
paises$nombre_corto[paises$nombre_corto == "United States of America"] <- "United States"
paises[nrow(paises)+1, ] = c("Europe", "North Macedonia")
paises$nombre_corto[paises$nombre_corto == "Cote d'Ivoire"] <- "Ivory Coast"
paises$nombre_corto[paises$nombre_corto == "Russian Federation"] <- "Russia"
paises$nombre_corto[paises$nombre_corto == "Syrian Arab Republic"] <- "Syria"
paises$nombre_corto[paises$nombre_corto == "Slovakia (Slovak Republic)"] <- "Slovakia"
paises$nombre_corto[paises$nombre_corto == "Libyan Arab Jamahiriya"] <- "Libya"
paises$nombre_corto[paises$nombre_corto == "Kyrgyz Republic"] <- "Kyrgyzstan"
paises$nombre_corto[paises$nombre_corto == "Timor-Leste"] <- "Timor"
paises[nrow(paises)+1, ] <- c("Asia", "South Korea")
paises[nrow(paises)+1, ] <- c("Asia", "North Korea")
paises[nrow(paises)+1, ] <- c("Europe", "Kosovo")
#corrijo paises mal escritos en la base
base$Country.1[base$Country.1 == "UK"] <- "United Kingdom"
base$Country.1[base$Country.1 == "India "] <- "India"
base$Country.1[base$Country.1 == "DR Congo"] <- "Congo"
levels(base$Country.2) <- as.factor(c(levels(base$Country.2), "Congo"))
base$Country.2[base$Country.2 == "DR Congo"] <- "Congo"
base$Country.2[base$Country.2 == "USA"] <- "United States"
base$Country.2[base$Country.2 == "Spain "] <- "Spain"
base$Country.2[base$Country.2 == "Serbia "] <- "Serbia"
base$Country.2[base$Country.2 == "Croatia "] <- "Croatia"
base$Country.2[base$Country.2 == "Northern Ireland"] <- "United Kingdom"
levels(base$Country.2) <- as.factor(c(levels(base$Country.2), "Papua New Guinea"))
base$Country.2[base$Country.2 == "Papua-New-Guinea"] <- "Papua New Guinea"
levels(base$Country.3) <- as.factor(c(levels(base$Country.3), "Congo"))
base$Country.3[base$Country.3 == "DR Congo"] <- "Congo"
base$Country.3[base$Country.3 == "Serbia "] <- "Serbia"
base$Country.3[base$Country.3 == "Venezuela "] <- "Venezuela"
levels(base$Country.4) <- as.factor(c(levels(base$Country.4), "Congo"))
base$Country.4[base$Country.4 == "DR Congo"] <- "Congo"
#creo cuatro variables continente, 1 por pais
base <- dplyr::left_join(base, paises, by=c("Country.1" = "nombre_corto"), keep= FALSE, suffix=c("1","2"))
base <- dplyr::left_join(base, paises, by=c("Country.2" = "nombre_corto"), keep= FALSE, suffix=c("1","2"))
base <- dplyr::left_join(base, paises, by=c("Country.3" = "nombre_corto"), keep= FALSE, suffix=c("3","4"))
base <- dplyr::left_join(base, paises, by=c("Country.4" = "nombre_corto"), keep= FALSE, suffix=c("3","4"))
#arreglo los paises/areas sin continente
#campo country.1
base$Continent_Name1[base$Country.1 == "Middle East"] <- "Asia"
base$Continent_Name1[base$Country.1 == "Asia"] <- "Asia"
base$Continent_Name1[base$Country.1 == "Africa"] <- "Africa"
base$Continent_Name1[base$Country.1 == "North Africa"] <- "Africa"
base$Continent_Name1[base$Country.1 == "West Africa"] <- "Africa"
base$Continent_Name1[base$Country.1 == "Southern Africa"] <- "Africa"
base$Continent_Name1[base$Country.1 == "East Africa"] <- "Africa"
base$Continent_Name1[base$Country.1 == "Europe"] <- "Europe"
base$Continent_Name1[base$Country.1 == "South America"] <- "South America"
base$Continent_Name1[base$Country.1 == "North America"] <- "North America"
#campo country.2
base$Continent_Name2[base$Country.2 == "Middle East"] <- "Asia"
base$Continent_Name2[base$Country.2 == "Asia"] <- "Asia"
base$Continent_Name2[base$Country.2 == "Africa"] <- "Africa"
base$Continent_Name2[base$Country.2 == "North Africa"] <- "Africa"
base$Continent_Name2[base$Country.2 == "West Africa"] <- "Africa"
base$Continent_Name2[base$Country.2 == "Southern Africa"] <- "Africa"
base$Continent_Name2[base$Country.2 == "East Africa"] <- "Africa"
base$Continent_Name2[base$Country.2 == "Europe"] <- "Europe"
base$Continent_Name2[base$Country.2 == "South America"] <- "South America"
base$Continent_Name2[base$Country.2 == "North America"] <- "North America"
#campo country.3
base$Continent_Name3[base$Country.3 == "Middle East"] <- "Asia"
base$Continent_Name3[base$Country.3 == "Asia"] <- "Asia"
base$Continent_Name3[base$Country.3 == "Africa"] <- "Africa"
base$Continent_Name3[base$Country.3 == "North Africa"] <- "Africa"
base$Continent_Name3[base$Country.3 == "West Africa"] <- "Africa"
base$Continent_Name3[base$Country.3 == "Southern Africa"] <- "Africa"
base$Continent_Name3[base$Country.3 == "East Africa"] <- "Africa"
base$Continent_Name3[base$Country.3 == "Europe"] <- "Europe"
base$Continent_Name3[base$Country.3 == "South America"] <- "South America"
base$Continent_Name3[base$Country.3 == "North America"] <- "North America"
#campo country.4
base$Continent_Name4[base$Country.4 == "Central America"] <- "North America"
total_x_pais <- rbind(as.data.frame(table(base$Country.1)), as.data.frame(table(base$Country.2)),as.data.frame(table(base$Country.3)),as.data.frame(table(base$Country.4)))
total_x_pais <- aggregate(total_x_pais$Freq, by=list(Var1 = total_x_pais$Var1), FUN=sum)
table(total_x_pais$Var1)
total_x_pais <- rbind(as.data.frame(table(base$Country.1)), as.data.frame(table(base$Country.2)),as.data.frame(table(base$Country.3)),as.data.frame(table(base$Country.4)))
total_x_pais <- aggregate(total_x_pais$Freq, by=list(Var1 = total_x_pais$Var1), FUN=sum)
table(total_x_pais$Var1)
total_x_pais <- rbind(as.data.frame(table(base$Country.1)), as.data.frame(table(base$Country.2)),as.data.frame(table(base$Country.3)),as.data.frame(table(base$Country.4)))
View(total_x_pais)
sum(total_x_pais$Freq)
table(!is.na(base$Country.1))
table(!is.na(base$Country.2))
table(!is.na(base$Country.3))
table(!is.na(base$Country.4))
86+11013+1176+257
head(total_x_pais)
total_x_pais <- aggregate(total_x_pais$Freq, by=list(Var1 = total_x_pais$Var1), FUN=sum)
sum(total_x_pais$x)
colnames(total_x_pais) <- c("name", "Freq")
countries_p <- readOGR("custom.geo.json")
countries_p@data <- left_join(countries_p@data, total_x_pais, by=c("name"))
sum(countries_p@data$Freq)
str(countries_p@data$Freq)
sum(countries_p@data$Freq, na.omit=TRUE)
sum(countries_p@data$Freq, na.rm=TRUE)
desp_join <- cbind(countries_p@data$name, countries_p@data$Freq)
View(desp_join)
#full join
full_join(total_x_pais,desp_join)
#full join
full_join(total_x_pais,desp_join, by=c(total_x_pais$name = desp_join$V1 ))
#full join
full_join(total_x_pais,desp_join, by=c(total_x_pais$name == desp_join$V1 ))
#full join
full_join(total_x_pais,desp_join, by=c("name" = "V1" ))
total_x_pais %>% full_join(desp_join, by = c("name" = "V1"))
View(total_x_pais)
str(total_x_pais)
str(desp_join)
desp_join <- as.data.frame(countries_p@data$name, countries_p@data$Freq)
View(desp_join)
desp_join <- as.data.frame(cbind(countries_p@data$name, countries_p@data$Freq))
View(desp_join)
#full join
full_join(total_x_pais,desp_join, by=c("name" = "V1" ))
#full join
View(full_join(total_x_pais,desp_join, by=c("name" = "V1" )))
#full join
chequeo_mapa <- full_join(total_x_pais,desp_join, by=c("name" = "V1" ))
sum(chequeo_mapa$Freq)
str(chequeo_mapa)
sum(chequeo_mapa$Freq, na.rm=TRUE
)
View(chequeo_mapa[is.na(chequeo_mapa$V2),])
View(chequeo_mapa[is.na(chequeo_mapa$V2)&!is.na(chequeo_mapa$Freq),])
countries_p <- readOGR("custom.geo.json")
total_x_pais$name[total_x_pais$name=="North Macedonia"] <- "Macedonia"
total_x_pais$name[total_x_pais$name=="Bosnia and Herzegovina"] <- "Bosnia and Herz."
total_x_pais$name[total_x_pais$name=="South Korea"] <- "Korea"
total_x_pais$name[total_x_pais$name=="Singapore"] <- "Malaysia"
total_x_pais$name[total_x_pais$name=="Hong Kong"] <- "China"
total_x_pais$name[total_x_pais$name=="Ivory Coast"] <- "CÃ´te d'Ivoire"
total_x_pais$name[total_x_pais$name=="South Sudan"] <- "S. Sudan"
total_x_pais$name[total_x_pais$name=="Czech Republic"] <- "Czech Rep."
total_x_pais$name[total_x_pais$name=="Bahrain"] <- "Qatar"
total_x_pais$name[total_x_pais$name=="Timor-Leste"] <- "Timor"
total_x_pais$name[total_x_pais$name=="North Korea"] <- "Dem. Rep. Korea"
levels(total_x_pais) <- as.factor(c(levels(total_x_pais,)), "Bosnia and Herz.", "Korea", "CÃ´te d'Ivoire","Dem. Rep. Korea","Czech Rep.")
levels(total_x_pais) <- as.factor(c(levels(total_x_pais,), "Bosnia and Herz.", "Korea", "CÃ´te d'Ivoire","Dem. Rep. Korea","Czech Rep."))
levels(total_x_pais) <- as.factor(c(levels(total_x_pais), "Bosnia and Herz.", "Korea", "CÃ´te d'Ivoire","Dem. Rep. Korea","Czech Rep."))
total_x_pais$name[total_x_pais$name=="North Macedonia"] <- "Macedonia"
total_x_pais$name[total_x_pais$name=="Bosnia and Herzegovina"] <- "Bosnia and Herz."
total_x_pais$name[total_x_pais$name=="South Korea"] <- "Korea"
total_x_pais$name[total_x_pais$name=="Singapore"] <- "Malaysia"
total_x_pais$name[total_x_pais$name=="Hong Kong"] <- "China"
total_x_pais$name[total_x_pais$name=="Ivory Coast"] <- "CÃ´te d'Ivoire"
total_x_pais$name[total_x_pais$name=="South Sudan"] <- "S. Sudan"
total_x_pais$name[total_x_pais$name=="Czech Republic"] <- "Czech Rep."
total_x_pais$name[total_x_pais$name=="Bahrain"] <- "Qatar"
total_x_pais$name[total_x_pais$name=="Timor-Leste"] <- "Timor"
total_x_pais$name[total_x_pais$name=="North Korea"] <- "Dem. Rep. Korea"
levels(total_x_pais$name) <- as.factor(c(levels(total_x_pais$name), "Bosnia and Herz.", "Korea", "CÃ´te d'Ivoire","Dem. Rep. Korea","Czech Rep."))
total_x_pais$name[total_x_pais$name=="North Macedonia"] <- "Macedonia"
total_x_pais$name[total_x_pais$name=="Bosnia and Herzegovina"] <- "Bosnia and Herz."
total_x_pais$name[total_x_pais$name=="South Korea"] <- "Korea"
total_x_pais$name[total_x_pais$name=="Singapore"] <- "Malaysia"
total_x_pais$name[total_x_pais$name=="Hong Kong"] <- "China"
total_x_pais$name[total_x_pais$name=="Ivory Coast"] <- "CÃ´te d'Ivoire"
total_x_pais$name[total_x_pais$name=="South Sudan"] <- "S. Sudan"
total_x_pais$name[total_x_pais$name=="Czech Republic"] <- "Czech Rep."
total_x_pais$name[total_x_pais$name=="Bahrain"] <- "Qatar"
total_x_pais$name[total_x_pais$name=="Timor-Leste"] <- "Timor"
total_x_pais$name[total_x_pais$name=="North Korea"] <- "Dem. Rep. Korea"
levels(total_x_pais$name) <- as.factor(c(levels(total_x_pais$name), "Bosnia and Herz.", "Korea", "CÃ´te d'Ivoire","Dem. Rep. Korea","Czech Rep.","S. Sudan"))
total_x_pais$name[total_x_pais$name=="North Macedonia"] <- "Macedonia"
total_x_pais$name[total_x_pais$name=="Bosnia and Herzegovina"] <- "Bosnia and Herz."
total_x_pais$name[total_x_pais$name=="South Korea"] <- "Korea"
total_x_pais$name[total_x_pais$name=="Singapore"] <- "Malaysia"
total_x_pais$name[total_x_pais$name=="Hong Kong"] <- "China"
total_x_pais$name[total_x_pais$name=="Ivory Coast"] <- "CÃ´te d'Ivoire"
total_x_pais$name[total_x_pais$name=="South Sudan"] <- "S. Sudan"
total_x_pais$name[total_x_pais$name=="Czech Republic"] <- "Czech Rep."
total_x_pais$name[total_x_pais$name=="Bahrain"] <- "Qatar"
total_x_pais$name[total_x_pais$name=="Timor-Leste"] <- "Timor"
total_x_pais$name[total_x_pais$name=="North Korea"] <- "Dem. Rep. Korea"
countries_p@data <- left_join(countries_p@data, total_x_pais, by=c("name"))
desp_join <- as.data.frame(cbind(countries_p@data$name, countries_p@data$Freq))
#full join
chequeo_mapa <- full_join(total_x_pais,desp_join, by=c("name" = "V1" ))
View(chequeo_mapa[is.na(chequeo_mapa$V2)&!is.na(chequeo_mapa$Freq),])
total_x_pais <- rbind(as.data.frame(table(base$Country.1)), as.data.frame(table(base$Country.2)),as.data.frame(table(base$Country.3)),as.data.frame(table(base$Country.4)))
total_x_pais <- aggregate(total_x_pais$Freq, by=list(Var1 = total_x_pais$Var1), FUN=sum)
#cambio los nombres de las columnas y elimino valores nulos
colnames(total_x_pais) <- c("País", "Freq")
total_x_pais <- total_x_pais[total_x_pais$País != "", ]
#modifico las columnas para armar el mapa
colnames(total_x_pais) <- c("name", "Freq")
#corrijo algunos paises para que no falle el joineo
levels(total_x_pais$name) <- as.factor(c(levels(total_x_pais$name), "Bosnia and Herz.", "Korea", "CÃ´te d'Ivoire","Dem. Rep. Korea","Czech Rep.","S. Sudan"))
total_x_pais$name[total_x_pais$name=="North Macedonia"] <- "Macedonia"
total_x_pais$name[total_x_pais$name=="Bosnia and Herzegovina"] <- "Bosnia and Herz."
total_x_pais$name[total_x_pais$name=="South Korea"] <- "Korea"
total_x_pais$name[total_x_pais$name=="Singapore"] <- "Malaysia"
total_x_pais$name[total_x_pais$name=="Hong Kong"] <- "China"
total_x_pais$name[total_x_pais$name=="Ivory Coast"] <- "CÃ´te d'Ivoire"
total_x_pais$name[total_x_pais$name=="South Sudan"] <- "S. Sudan"
total_x_pais$name[total_x_pais$name=="Czech Republic"] <- "Czech Rep."
total_x_pais$name[total_x_pais$name=="Bahrain"] <- "Qatar"
total_x_pais$name[total_x_pais$name=="Timor-Leste"] <- "Timor"
total_x_pais$name[total_x_pais$name=="North Korea"] <- "Dem. Rep. Korea"
#leo el mapa y joineo datos
countries_p <- readOGR("custom.geo.json")
countries_p@data <- left_join(countries_p@data, total_x_pais, by=c("name"))
desp_join <- as.data.frame(cbind(countries_p@data$name, countries_p@data$Freq))
#full join
chequeo_mapa <- full_join(total_x_pais,desp_join, by=c("name" = "V1" ))
View(chequeo_mapa[is.na(chequeo_mapa$V2)&!is.na(chequeo_mapa$Freq),])
total_x_pais$Freq[total_x_pais$name == "Middle East"] / 4 + countries_p@data$Freq[countries_p@data$name == "Saudi Arabia"]
158/4
+18
158/4 + 8
#compilo el total de casos por país
total_x_pais <- rbind(as.data.frame(table(base$Country.1)), as.data.frame(table(base$Country.2)),as.data.frame(table(base$Country.3)),as.data.frame(table(base$Country.4)))
total_x_pais <- aggregate(total_x_pais$Freq, by=list(Var1 = total_x_pais$Var1), FUN=sum)
#cambio los nombres de las columnas y elimino valores nulos
colnames(total_x_pais) <- c("País", "Freq")
total_x_pais <- total_x_pais[total_x_pais$País != "", ]
#modifico las columnas para armar el mapa
colnames(total_x_pais) <- c("name", "Freq")
#corrijo algunos paises para que no falle el joineo
levels(total_x_pais$name) <- as.factor(c(levels(total_x_pais$name), "Bosnia and Herz.", "Korea", "CÃ´te d'Ivoire","Dem. Rep. Korea","Czech Rep.","S. Sudan"))
total_x_pais$name[total_x_pais$name=="North Macedonia"] <- "Macedonia"
total_x_pais$name[total_x_pais$name=="Bosnia and Herzegovina"] <- "Bosnia and Herz."
total_x_pais$name[total_x_pais$name=="South Korea"] <- "Korea"
total_x_pais$name[total_x_pais$name=="Singapore"] <- "Malaysia"
total_x_pais$name[total_x_pais$name=="Hong Kong"] <- "China"
total_x_pais$name[total_x_pais$name=="Ivory Coast"] <- "CÃ´te d'Ivoire"
total_x_pais$name[total_x_pais$name=="South Sudan"] <- "S. Sudan"
total_x_pais$name[total_x_pais$name=="Czech Republic"] <- "Czech Rep."
total_x_pais$name[total_x_pais$name=="Bahrain"] <- "Qatar"
total_x_pais$name[total_x_pais$name=="Timor-Leste"] <- "Timor"
total_x_pais$name[total_x_pais$name=="North Korea"] <- "Dem. Rep. Korea"
#leo el mapa y joineo datos
countries_p <- readOGR("custom.geo.json")
#guardo el original para usarlo en el paso siguiente
countries <- countries_p
countries_p@data <- left_join(countries_p@data, total_x_pais, by=c("name"))
countries_p@data$Freq[countries_p@data$name == "Armenia"] <- total_x_pais$Freq[total_x_pais$name == "Middle East"] / 4
countries_p@data$Freq[countries_p@data$name == "Iran"] <- total_x_pais$Freq[total_x_pais$name == "Middle East"] / 4 + countries_p@data$Freq[countries_p@data$name == "Iran"]
countries_p@data$Freq[countries_p@data$name == "Iraq"] <- total_x_pais$Freq[total_x_pais$name == "Middle East"] / 4 + countries_p@data$Freq[countries_p@data$name == "Iraq"]
countries_p@data$Freq[countries_p@data$name == "Saudi Arabia"] <- total_x_pais$Freq[total_x_pais$name == "Middle East"] / 4 + countries_p@data$Freq[countries_p@data$name == "Saudi Arabia"]
countries_p@data$Freq[countries_p@data$name == "Algeria"] <- total_x_pais$Freq[total_x_pais$name == "North Africa"] / 4 + countries_p@data$Freq[countries_p@data$name == "Algeria"]
countries_p@data$Freq[countries_p@data$name == "Morocco"] <- total_x_pais$Freq[total_x_pais$name == "North Africa"] / 4 + countries_p@data$Freq[countries_p@data$name == "Morocco"]
countries_p@data$Freq[countries_p@data$name == "Egypt"] <- total_x_pais$Freq[total_x_pais$name == "North Africa"] / 4 + countries_p@data$Freq[countries_p@data$name == "Egypt"]
countries_p@data$Freq[countries_p@data$name == "Libya"] <- total_x_pais$Freq[total_x_pais$name == "North Africa"] / 4 + countries_p@data$Freq[countries_p@data$name == "Libya"]
desp_join <- as.data.frame(cbind(countries_p@data$name, countries_p@data$Freq))
chequeo_mapa <- full_join(total_x_pais,desp_join, by=c("name" = "V1" ))
View(chequeo_mapa[is.na(chequeo_mapa$V2)&!is.na(chequeo_mapa$Freq),])
#defino la paleta de colores
pal <- colorNumeric("Reds", NULL)
#defino los valores de los popup
state_popup <- paste0("<strong>Pais: </strong>",
countries_p$name,
"<br><strong>Cantidad </strong>",
countries_p$Freq)
#grafico el mapa
leaflet(countries_p) %>%
addTiles() %>%
addPolygons(stroke = FALSE, smoothFactor = 0.3, fillOpacity = 1,
fillColor = ~pal(Freq),
popup = state_popup) %>%
addLegend(pal = pal, values = ~Freq, opacity = 1.0,
labFormat = labelFormat(transform = function(x) round(x))) %>%
setView(lng = -0, lat = 0, zoom = 1)
ls
ls()
